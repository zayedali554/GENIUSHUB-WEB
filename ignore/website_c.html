<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website C - Content</title>
    <style>
        :root {
            --primary-bg: #0f0f1e;
            --secondary-bg: #1a1a2e;
            --accent-primary: #00a2ff;
            --accent-secondary: #0066cc;
            --accent-gradient: linear-gradient(135deg, #00a2ff 0%, #0066cc 100%);
            --bg-tertiary: #1e1e35;
            --text-primary: #ffffff;
            --text-secondary: #a0a0c0;
            --success: #44ff44;
            --error: #ff4444;
            --warning: #ffcc00;
            --content-bg: #d1ecf1;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--primary-bg) 0%, var(--secondary-bg) 100%);
            margin: 0;
            position: relative;
            overflow-x: hidden;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 800px;
            width: 90%;
            margin: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            font-size: 36px;
        }
        
        h1 {
            color: var(--accent-primary);
            margin-bottom: 16px;
            font-size: 32px;
        }
        
        p {
            margin-top: 20px;
            color: var(--text-secondary);
            font-size: 18px;
            line-height: 1.6;
        }
        
        a {
            display: inline-block;
            margin-top: 20px;
            text-decoration: none;
            color: var(--accent-primary);
            font-weight: 600;
            padding: 12px 24px;
            border-radius: 8px;
            transition: all 0.2s ease;
            background: rgba(0, 123, 255, 0.1);
        }
        
        a:hover {
            background: rgba(0, 123, 255, 0.2);
            transform: translateY(-2px);
        }
        

        
        @media (max-width: 768px) {
            .container {
                padding: 30px 20px;
            }
            
            h1 {
                font-size: 28px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">ðŸ”’</div>
        <h1>TEST PAGE</h1>
    </div>
    


    <script>
        // Secure Cookie System with HMAC Signing
        // This prevents users from extending cookie expiry through DevTools
        
        // Secret key for HMAC signing (must match the one in success.html)
        const HMAC_SECRET = 'gh-secure-key-2024-v1';
        
        // Secure Cookie Management
        class SecureCookie {
            static async generateHMACKey(secret) {
                const encoder = new TextEncoder();
                const keyData = encoder.encode(secret);
                return await crypto.subtle.importKey(
                    'raw',
                    keyData,
                    { name: 'HMAC', hash: 'SHA-256' },
                    false,
                    ['sign', 'verify']
                );
            }
            
            static async verifySecureToken(token) {
                try {
                    const [payloadB64, signatureB64] = token.split('.');
                    if (!payloadB64 || !signatureB64) return null;
                    
                    const payloadStr = atob(payloadB64);
                    const payload = JSON.parse(payloadStr);
                    
                    // Check expiration
                    if (Date.now() > payload.exp) {
                        console.log('Token expired:', new Date(payload.exp));
                        return null;
                    }
                    
                    // Verify signature
                    const encoder = new TextEncoder();
                    const payloadBytes = encoder.encode(payloadStr);
                    const signatureBytes = new Uint8Array(atob(signatureB64).split('').map(c => c.charCodeAt(0)));
                    
                    const key = await this.generateHMACKey(HMAC_SECRET);
                    const isValid = await crypto.subtle.verify('HMAC', key, signatureBytes, payloadBytes);
                    
                    if (!isValid) {
                        console.log('Invalid token signature');
                        return null;
                    }
                    
                    return payload;
                } catch (error) {
                    console.log('Token verification failed:', error);
                    return null;
                }
            }
        }
        
        // Helper function to get cookie
        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
        }
        
        // Secure access validation
        (async function() {
            const secureToken = getCookie('geniushub-key');
            
            if (!secureToken) {
                console.log('No secure token found, redirecting to key generation');
                window.location.replace('generate-key.html');
                return;
            }
            
            const payload = await SecureCookie.verifySecureToken(secureToken);
            
            if (!payload || payload.data !== 'success') {
                console.log('Invalid or expired secure token, redirecting to key generation');
                // Remove invalid token
                document.cookie = 'geniushub-key=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/; SameSite=Strict';
                window.location.replace('generate-key.html');
                return;
            }
            
            console.log('User has valid secure access to Website C');
            console.log('Token expires:', new Date(payload.exp));
        })();
    </script>
</body>
</html>